(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{197:function(t,a,s){"use strict";s.r(a);var e=s(6),r=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"数据库安全与保护"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#数据库安全与保护"}},[t._v("#")]),t._v(" 数据库安全与保护")]),t._v(" "),s("h2",{attrs:{id:"数据库完整性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#数据库完整性"}},[t._v("#")]),t._v(" 数据库完整性")]),t._v(" "),s("h4",{attrs:{id:"完整性约束条件的作用对象"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#完整性约束条件的作用对象"}},[t._v("#")]),t._v(" 完整性约束条件的作用对象")]),t._v(" "),s("ul",[s("li",[t._v("列级约束")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("主要指对列的类型、取值范围、精度等的约束\n")])])]),s("ul",[s("li",[t._v("元组约束")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("元组中各个字段之间的相互约束\n")])])]),s("ul",[s("li",[t._v("表级约束")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("若干元组之间、关系之间的联系的约束\n")])])]),s("h4",{attrs:{id:"定义与实现完整性约束"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#定义与实现完整性约束"}},[t._v("#")]),t._v(" 定义与实现完整性约束")]),t._v(" "),s("ol",[s("li",[t._v("实体完整性")])]),t._v(" "),s("ul",[s("li",[t._v("主键约束")]),t._v(" "),s("li",[t._v("候选键约束\n"),s("ul",[s("li",[t._v("一个表中只能创建一个主键，但可以定义若干个候选键")]),t._v(" "),s("li",[t._v("定义主键约束时，系统会自动产生primary key索引，而定义候选键约束时，系统会总动产生unique索引")])])])]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[t._v("参照完整性")])]),t._v(" "),s("blockquote",[s("p",[t._v("主要是指二个表之间的关系")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("references customer(cust_id) on delete restrict\n")])])]),s("ol",{attrs:{start:"3"}},[s("li",[t._v("用户定义的完整性")])]),t._v(" "),s("ul",[s("li",[t._v("非空约束")])]),t._v(" "),s("blockquote",[s("p",[t._v("not null")])]),t._v(" "),s("ul",[s("li",[t._v("check约束")])]),t._v(" "),s("blockquote",[s("p",[t._v("check(expr)")])]),t._v(" "),s("h4",{attrs:{id:"命名完整性约束"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#命名完整性约束"}},[t._v("#")]),t._v(" 命名完整性约束")]),t._v(" "),s("blockquote",[s("p",[t._v("constraint(symbol) //symbol在数据库中必须是唯一的")])]),t._v(" "),s("h4",{attrs:{id:"更新完整性约束"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#更新完整性约束"}},[t._v("#")]),t._v(" 更新完整性约束")]),t._v(" "),s("blockquote",[s("p",[t._v("可在alter table 语句中使用add constraint")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("alter table custom drop primary key\n\nalter table custom drop foreign ket [外键约束名]\n")])])]),s("hr"),t._v(" "),s("h2",{attrs:{id:"触发器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#触发器"}},[t._v("#")]),t._v(" 触发器")]),t._v(" "),s("h4",{attrs:{id:"创建触发器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建触发器"}},[t._v("#")]),t._v(" 创建触发器")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("create trigger trigger_name trigger_time trigger_event on tab_name for\neach row trigger_body\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("Q: 在数据库test表custom中创建一个触发器custom_trigger，用于每次向表\ncustom插入一行数据时，将用户变量str的值设置为‘one customer add’\n\n\ncreate trigger custom_trigger after insert on custom for each row\nset str @str='one customer add'\n")])])]),s("h4",{attrs:{id:"删除触发器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#删除触发器"}},[t._v("#")]),t._v(" 删除触发器")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("drop trigger_name\n")])])]),s("h4",{attrs:{id:"使用触发器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用触发器"}},[t._v("#")]),t._v(" 使用触发器")]),t._v(" "),s("ul",[s("li",[t._v("insert触发器")]),t._v(" "),s("li",[t._v("update触发器")]),t._v(" "),s("li",[t._v("delete触发器")])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"安全性与访问控制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安全性与访问控制"}},[t._v("#")]),t._v(" 安全性与访问控制")]),t._v(" "),s("h4",{attrs:{id:"用户账号管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#用户账号管理"}},[t._v("#")]),t._v(" 用户账号管理")]),t._v(" "),s("ol",[s("li",[t._v("创建用户账号")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("create user 'zhangsan'@'localhost' identified by '123'\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[t._v("删除用户")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("drop user lisi \n")])])]),s("blockquote",[s("p",[t._v("必须拥有数据库的delete权限或全局create user权限")])]),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[t._v("修改用户账号")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("rename user 'zhangsan'@'localhost' to 'wangwu'@'localhost'\n")])])]),s("blockquote",[s("p",[t._v("必须拥有数据库的update权限或全局create user权限")])]),t._v(" "),s("ol",{attrs:{start:"4"}},[s("li",[t._v("修改用户口令")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("set password for 'wangwu'@'localhost'='123123123123'\n")])])]),s("h4",{attrs:{id:"账户权限管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#账户权限管理"}},[t._v("#")]),t._v(" 账户权限管理")]),t._v(" "),s("ol",[s("li",[t._v("权限的授予")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("grant all on mysql to 'wangwu'@'localhost'\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[t._v("权限的转移")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("Q： 授予当前系统中一个不存在的用于zhou在数据库mysql表上所有的权限，\n并且允许将自身的权限授予其他用户\n\ngrant all on mysql to 'zhou'@'localhost' identified by '123' with grant option\n")])])]),s("ol",{attrs:{start:"3"}},[s("li",[t._v("权限的撤销")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("revoke all on mysql from 'zhou'@'localhost'\n")])])]),s("hr"),t._v(" "),s("h2",{attrs:{id:"事务与并发控制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#事务与并发控制"}},[t._v("#")]),t._v(" 事务与并发控制")]),t._v(" "),s("h4",{attrs:{id:"事务的概念"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#事务的概念"}},[t._v("#")]),t._v(" 事务的概念")]),t._v(" "),s("blockquote",[s("p",[t._v("是用户定义的一个数据操作序列，要么全部执行，要么全部不执行，事务与程序是二个概念")])]),t._v(" "),s("h4",{attrs:{id:"事务的特征"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#事务的特征"}},[t._v("#")]),t._v(" 事务的特征")]),t._v(" "),s("ul",[s("li",[t._v("原子性(Atomicity)")]),t._v(" "),s("li",[t._v("一致性(Consistency)")]),t._v(" "),s("li",[t._v("隔离性(Isolation)")]),t._v(" "),s("li",[t._v("持续性(Durability)")])]),t._v(" "),s("h4",{attrs:{id:"并发操作问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#并发操作问题"}},[t._v("#")]),t._v(" 并发操作问题")]),t._v(" "),s("ol",[s("li",[t._v("丢失更新")]),t._v(" "),s("li",[t._v("不可重复读")]),t._v(" "),s("li",[t._v("读‘脏’数据")])]),t._v(" "),s("h4",{attrs:{id:"封锁"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#封锁"}},[t._v("#")]),t._v(" 封锁")]),t._v(" "),s("blockquote",[s("p",[t._v("需要时，事务通过向系统请求对它所希望的数据对象加锁，以确保它不被非预期改变")])]),t._v(" "),s("ol",[s("li",[t._v("锁")])]),t._v(" "),s("blockquote",[s("p",[t._v("一个锁实质上就是允许或阻止一个事务对一个数据对象的存取特权。基本的封锁类型有二种：排它锁(Exclusive Lock,X锁)、共享锁(Shared Lock,S锁)")])]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[t._v("用封锁进行并发控制")])]),t._v(" "),s("ul",[s("li",[t._v("若事务T对数据D加了X锁，则所有别的事务对数据D的锁请求都必须等待直到事务T释放锁")]),t._v(" "),s("li",[t._v("若事务T对数据D加了S锁，则别的事务还可对数据D请求S锁，而对数据D的X锁请求必须等待直到事务T释放锁")]),t._v(" "),s("li",[t._v("事务执行数据库操作都要先请求对应的锁，即对读请求S锁，对更新、插入、删除请求X锁")]),t._v(" "),s("li",[t._v("事务一直占有获得的锁直到结束时释放")])]),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[t._v("封锁的粒度")])]),t._v(" "),s("blockquote",[s("p",[t._v("通常以粒度来描述封锁的数据单元大小，DBMS可以决定不同粒度的锁，由最底层的数据元素到最高层的整个数据库，粒度越细，并发性越大，但软件复杂性和系统开销也就越大")])]),t._v(" "),s("ol",{attrs:{start:"4"}},[s("li",[t._v("封锁的级别")])]),t._v(" "),s("ul",[s("li",[t._v("0级封锁")])]),t._v(" "),s("blockquote",[s("p",[t._v("封锁的事务不重写其他非0级封锁事务的未提交的更新数据")])]),t._v(" "),s("ul",[s("li",[t._v("1级封锁")])]),t._v(" "),s("blockquote",[s("p",[t._v("被封锁的事务不允许重写未提交的更新数据。这防止了丢失更新的发生")])]),t._v(" "),s("ul",[s("li",[t._v("2级封锁")])]),t._v(" "),s("blockquote",[s("p",[t._v("被封锁的事务即不重写也不读未提交的更新数据，这出了1级封锁效果还防止了读脏数据")])]),t._v(" "),s("ul",[s("li",[t._v("3级封锁")])]),t._v(" "),s("blockquote",[s("p",[t._v("被封锁的事务不读未提交的更新数据，不写任何未提交的数据")])]),t._v(" "),s("ol",{attrs:{start:"5"}},[s("li",[t._v("活锁与死锁")])]),t._v(" "),s("ul",[s("li",[t._v("活锁")])]),t._v(" "),s("blockquote",[s("p",[t._v("由于锁会使一个事务处于等待状态而调度其他事务处理，因而该事务可能会因优先级别低而永远等待下去\n解决方法： 先来先服务")])]),t._v(" "),s("ul",[s("li",[t._v("死锁")])]),t._v(" "),s("blockquote",[s("p",[t._v("一次性锁请求。锁请求排序。序列化处理。资源剥夺")])]),t._v(" "),s("ol",{attrs:{start:"6"}},[s("li",[t._v("可串行性")])]),t._v(" "),s("blockquote",[s("p",[t._v("一组事务的一个调度就是它们的基本操作的一种排序。可串行性就是并发执行的正确性准则，即当且仅当一组事务的并发执行调度是可串行化的，才认为它是正确的")])]),t._v(" "),s("ol",{attrs:{start:"7"}},[s("li",[t._v("二段封锁法")])]),t._v(" "),s("ul",[s("li",[t._v("发展或加锁阶段")]),t._v(" "),s("li",[t._v("收缩或释放锁阶段")])]),t._v(" "),s("blockquote",[s("p",[t._v("遵循二段锁协议的事务的任何并发调度都是可串行化的")])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"备份与恢复"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#备份与恢复"}},[t._v("#")]),t._v(" 备份与恢复")]),t._v(" "),s("p",[t._v("Q: 数据丢失或被破坏可能的原因")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("1. 计算机硬件故障\n2. 计算机软件故障\n3. 病毒\n4. 自然灾害\n5. 人为误操作\n6. 盗窃\n")])])]),s("blockquote",[s("p",[t._v("不足：只能导出或导入数据的内容，而不包括表的结构，如果表的结构文件损坏，必须设法先恢复原表结构")])]),t._v(" "),s("h4",{attrs:{id:"select-into-outfile"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#select-into-outfile"}},[t._v("#")]),t._v(" select into--outfile")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("select * into outfile 'file_name' export_options\n")])])]),s("h4",{attrs:{id:"load-data-intfile"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#load-data-intfile"}},[t._v("#")]),t._v(" load data--intfile")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("\nQ： 备份表mysql的全部数据到c/backup/back,txt中，要求字段值如果是字符则用双引号标注，\n每行以‘？’结束\n\nselect * from mysql\ninto outfile 'c/backup/back,txt' \nfields terminated by ',' \noptionally enclosed by ''\nlines terminated by '?'\n")])])])])}),[],!1,null,null,null);a.default=r.exports}}]);